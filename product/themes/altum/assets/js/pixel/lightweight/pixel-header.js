let send_data_beacon=e=>{try{let t=new FormData;t.append("data",JSON.stringify(e)),navigator.sendBeacon(`${pixel_url_base}pixel-track/${pixel_key}`,t)}catch(r){console.log(`Analytics pixel: ${r}`)}};class AltumCodeEvents{constructor(){window[pixel_exposed_identifier]={goal:e=>{this.event_goal_conversion(e)}};let e=new URLSearchParams(window.location.search),t={path:window.location.pathname+(pixel_query_parameters_tracking_is_enabled?"?"+new URL(document.location.toString()).searchParams.toString():""),referrer:document.referrer.includes(`${location.protocol}//${location.host}${location.pathname}`)?null:document.referrer,utm:{source:e.get("utm_source"),medium:e.get("utm_medium"),campaign:e.get("utm_campaign")},resolution:{width:window.screen.width,height:window.screen.height}},r=document.createElement("a");r.href=document.referrer;let a=document.createElement("a");a.href=window.location.href;let n=""==document.referrer.trim()||r.hostname!=a.hostname?"landing_page":"pageview";if(send_data_beacon({type:n,url:window.location.href,data:t}),pixel_goals.length){let o=get_current_url_domain_no_www();for(let l of pixel_goals)"pageview"==l.type&&(l.url==o||l.url=="www."+o)&&this.event_goal_conversion(l.key)}}event_goal_conversion(e){for(let t of pixel_goals)if(t.key==e){send_data_beacon({type:"goal_conversion",url:window.location.href,goal_key:t.key});break}}}
